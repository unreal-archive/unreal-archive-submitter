dist: xenial
language: java

jdk:
  - openjdk11

cache:
  directories:
    - /home/travis/.ant/

before_install:
  - ./resources/install-ant.sh

jobs:
  include:
    - stage: test
      script: ~/.ant/ant/bin/ant test
    - stage: build and publish binaries
      if: branch = master
      script:
        - ~/.ant/ant/bin/ant bin
        - ./resources/publish.sh https://code.shrimpworks.za.net/artefacts/unreal-archive-submitter ./dist/unreal-archive-submitter ./dist/unreal-archive-submitter-exec.jar
